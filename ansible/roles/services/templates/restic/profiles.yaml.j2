# Resticprofile configuration
# Generated by Ansible

version: "1"

defaults:
  initialize: true
  password-file: "/root/resticprofile/.restic-password"
  retention:
    keep-daily: 7
    keep-weekly: 4
    keep-monthly: 12
  tag:
    host: "{{ ansible_host }}"
  backup:
    schedule: "daily"
    one-file-system: true
    schedule-after-network-online: true
    run-before: 'echo "### Starting Restic backup ###"'
    run-after: 'echo "### Restic backup finished ###"'

hetzner_defaults:
  inherit: defaults
  repository: "sftp:{{ hetzner_storage_box_user }}@{{ hetzner_storage_box_url }}:/backups/restic"
  env:
    RESTIC_SFTP_COMMAND: "ssh {{ hetzner_storage_box_user }}@{{ hetzner_storage_box_url }} -s sftp"

{{ restic_profiles | to_yaml }}
