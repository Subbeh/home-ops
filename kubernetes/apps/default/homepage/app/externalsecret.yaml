---
# yaml-language-server: $schema=https://kubernetes-schemas.pages.dev/external-secrets.io/externalsecret_v1.json
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: homepage
spec:
  secretStoreRef:
    kind: ClusterSecretStore
    name: vault
  target:
    name: homepage-secret
    template:
      data:
        # Infra
        HOMEPAGE_VAR_PVE_TOKEN: "{{ .pve_user }}!{{ .pve_token }}"
        HOMEPAGE_VAR_PVE_SECRET: "{{ .pve_token_value }}"
        HOMEPAGE_VAR_OPNSENSE_KEY: "{{ .opnsense_key }}"
        HOMEPAGE_VAR_OPNSENSE_SECRET: "{{ .opnsense_secret }}"
  data:
    # Infra
    - secretKey: pve_user
      remoteRef:
        key: ops/infra/pve-monitoring
        property: user
    - secretKey: pve_token
      remoteRef:
        key: ops/infra/pve-monitoring
        property: token
    - secretKey: pve_token_value
      remoteRef:
        key: ops/infra/pve-monitoring
        property: token_value
    - secretKey: opnsense_key
      remoteRef:
        key: ops/infra/opnsense
        property: key
    - secretKey: opnsense_secret
      remoteRef:
        key: ops/infra/opnsense
        property: secret
